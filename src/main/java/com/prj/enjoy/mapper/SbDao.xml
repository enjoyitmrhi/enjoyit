<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE mapper
	    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.prj.enjoy.saleboard.dao.SbDao">

	<select id="board_list_seminar" resultType="com.prj.enjoy.saleboard.dto.SbDto">
		SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN 1 AND 6 AND SBTYPE ='1'
		

	</select>
	<select id="board_list_practice" resultType="com.prj.enjoy.saleboard.dto.SbDto">
		SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN 1 AND 6 AND SBTYPE ='2'
		

	</select>
	<select id="board_list_party" resultType="com.prj.enjoy.saleboard.dto.SbDto">
		SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN 1 AND 6 AND SBTYPE ='3'
		

	</select>
	<select id="add_list1" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN #{param1} AND #{param2} AND SBTYPE ='1'
	
	</select>

	<select id="add_list2" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN #{param1} AND #{param2} AND SBTYPE ='2' 
	
	</select>
	
	<select id="add_list3" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID , SBTYPE,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN #{param1} AND #{param2} AND SBTYPE ='3'
	
	</select>

	<insert id="board_write">
		INSERT INTO
		SALE_BOARD(SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBLONGITUDE,SBLATITUDE,BUID,SBTYPE)
		VALUES(SBCODE_SEQ.NEXTVAL+1,(SELECT BUNUM FROM BUSINESS WHERE BUID =
		#{param1}),#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param1},#{param8} )

	</insert>
	
	<select id="sb_content" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT * FROM SALE_BOARD WHERE SBCODE = #{param1}
	
	</select>
	
	<delete id="delete">
	DELETE FROM SALE_BOARD WHERE SBCODE = #{param1}
	</delete>
	
	<delete id="del_reserv">
		DELETE FROM RESERVATION WHERE SBCODE = #{param1}
	</delete>
	<delete id="del_Review">
		DELETE FROM REVIEW WHERE SBCODE = #{param1}
	</delete>
	<delete id="del_Qna">
		DELETE FROM QNA WHERE SBCODE = #{param1}
	</delete>
	
	<update id="sbmodify">
	UPDATE SALE_BOARD SET SBLOC = 'CHANGEDLOC',SBPRICE = #{param2},SBTITLE=#{param3},SBCONTENT=#{param4},SBPIC=#{param5} WHERE SBCODE = #{param1}
	
	</update>
	
	<select id="avgstar" resultType="String">
	 
	SELECT AVG(RVSTAR) FROM REVIEW WHERE SBCODE = #{param1}
	 
	</select> 
	
	<select id="getSbPic" resultType="String">
		SELECT SBPIC FROM SALE_BOARD
		WHERE
		SBCODE=#{param1 }
	</select>
	
	
</mapper>
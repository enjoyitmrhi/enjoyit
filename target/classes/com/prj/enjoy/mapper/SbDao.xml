<?xml version="1.0" encoding="UTF-8"?>
	<!DOCTYPE mapper
	    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.prj.enjoy.saleboard.dao.SbDao">

	<select id="board_list" resultType="com.prj.enjoy.saleboard.dto.SbDto">
		SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID ,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN '1' AND '6'
		

	</select>
	<select id="add_list" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT
		SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID 
		FROM (
		SELECT SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBDATE,BUID ,
		ROW_NUMBER() OVER(ORDER BY SBCODE DESC) 
		SB_SEQ FROM SALE_BOARD ) WHERE SB_SEQ BETWEEN #{param1} AND #{param2}
	
	</select>

	

	<insert id="board_write">
		INSERT INTO
		SALE_BOARD(SBCODE,BUNUM,SBPIC,SBTITLE,SBPRICE,SBLOC,SBLONGITUDE,SBLATITUDE,BUID)
		VALUES(SBCODE_SEQ.NEXTVAL+1,(SELECT BUNUM FROM BUSINESS WHERE BUID =
		#{param1}),#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param1} )

	</insert>
	
	<select id="sb_content" resultType="com.prj.enjoy.saleboard.dto.SbDto">
	SELECT * FROM SALE_BOARD WHERE SBCODE = #{param1}
	
	</select>
	
	<delete id="delete">
	DELETE FROM SALE_BOARD WHERE SBCODE = #{param1}
	</delete>
	
	<update id="sbmodify">
	UPDATE SALE_BOARD SET SBLOC = #{param6} ,SBPRICE = #{param2},SBTITLE=#{param3},SBCONTENT=#{param4},SBPIC=#{param5},SBLONGITUDE=#{param7},SBLATITUDE=#{param8} WHERE SBCODE = #{param1}
	
	</update>
	
	<select id="avgstar" resultType="String">
	 
	SELECT AVG(RVSTAR) FROM REVIEW WHERE SBCODE = #{param1}
	 
	</select> 
	
	<select id="getSbPic" resultType="String">
		SELECT SBPIC FROM SALE_BOARD
		WHERE
		SBCODE=#{param1 }
	</select>
	
	<select id="getSbloc" resultType="String">
		SELECT SBLOC FROM SALE_BOARD
		WHERE
		SBCODE=#{param1 }
	</select>
	<select id="getSbLongitude" resultType="String">
		SELECT SBLONGITUDE FROM SALE_BOARD
		WHERE
		SBCODE=#{param1 }
	</select>
	<select id="getSbLatitude" resultType="String">
		SELECT SBLATITUDE FROM SALE_BOARD
		WHERE
		SBCODE=#{param1 }
	</select>
	
	
</mapper>